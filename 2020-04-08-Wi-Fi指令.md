---
title: "Wi-Fi指令"
date: 2020-04-08T16:51:09+08:00
draft: false
categories: ["技术"]
tags: ["经验"]
url: "/2020/04/08/wifi-cmd.html"
---

## # iwlist

用于对/proc/net/wireless文件进行分析，得出无线网卡相关信息

```
# iwlist wlan0 scanning 搜索当前无线网络
# iwlist wlan0 frequen  显示频道信息
# iwlist wlan0 rate  	显示连接速度
# iwlist wlan0 power  	显示电源模式
# iwlist wlan0 txpower 	显示功耗
# iwlist wlan0 retry  	显示重试连接次数(网络不稳定查看)
# iwlist wlan0 ap 		显示热点信息
# iwlist --help 		显示帮助信息
# iwlist --version 		显示版本信息
```


搜索到的某一信道实例

```
pi@raspberrypi:~ $ iwlist wlan0 scanning
wlan0     Scan completed :
          Cell 01 - Address: 30:4A:26:50:75:48
                    Channel:1
                    Frequency:2.412 GHz (Channel 1)
                    Quality=70/70  Signal level=-8 dBm  
                    Encryption key:on
                    ESSID:"lyndon_7549"
                    Bit Rates:1 Mb/s; 2 Mb/s; 5.5 Mb/s; 11 Mb/s; 9 Mb/s
                              18 Mb/s; 36 Mb/s; 54 Mb/s
                    Bit Rates:6 Mb/s; 12 Mb/s; 24 Mb/s; 48 Mb/s
                    Mode:Master
                    Extra:tsf=0000000000000000
                    Extra: Last beacon: 70ms ago

                    IE: IEEE 802.11i/WPA2 Version 1
                        Group Cipher : TKIP
                        Pairwise Ciphers (2) : TKIP CCMP
                        Authentication Suites (1) : PSK
```

每一个 Cell 代表一个无线网络

Address：MAC地址

Channel：信道

Frequency：中心频点

Quality：信号质量

Signal level：原始信号强度

ESSID：可以认为是SSID，Wi-Fi 网络名

Bit Rates：波特率

Mode:Master(接入点 AP)

IEEE 802.11i/WPA2 Version 1 加密方式

## # iwconfig

系统配置无线网络设备或显示无线网络设备信息。iwconfig 命令类似于ifconfig命令，但是他配置对象是无线网卡，它对网络设备进行无线操作，如设置无线通信频段

auto 		自动模式
essid 		设置ESSID
nwid 		设置网络ID
freq 		设置无线网络通信频段
chanel 	设置无线网络通信频段
sens 		设置无线网络设备的感知阀值
mode 		设置无线网络设备的通信设备
ap 					强迫无线网卡向给定地址的接入点注册
nick<名字> 	为网卡设定别名
rate<速率> 	设定无线网卡的速率
rts<阀值> 	在传输数据包之前增加一次握手，确信信道在正常的
power 		无线网卡的功率设置



## # iw

iw 是一种新的基于 nl80211 的用于无线设备的CLI配置实用程序。它支持最近已添加到内核所有新的驱动程序。采用无线扩展接口的旧工具iwconfig已被废弃，强烈建议切换到 iw 和 nl80211。
Linux内核的其余部分，iw 仍处于开发阶段。功能被随时添加。 iw 的唯一文档就是此页和“iw help”的输出。 请帮助扩大这个页面。
有一个页面列出iwconfig和iw的用例：替换 iwconfig.

```
# iw help    # 帮助
# iw list    # 获得所有设备的功能，如带宽信息（2.4GHz，和5GHz），和802.11n的信息
# iw dev wlan0 scan    # 扫描
# iw event    # 监听事件
# iw dev wlan0 link    # 获得链路状态
# iw wlan0 connect foo    # 连接到已禁用加密的AP，这里它的SSID是foo
# iw wlan0 connect foo 2432  # 假设你有两个AP SSID 都是 foo ，你知道你要连接的是在 2432 频道
# iw wlan0 connect foo keys 0:abcde d:1:0011223344    # 连接到使用WEP的AP
# iw dev wlan1 station dump    # 获取station 的统计信息
# iw dev wlan1 station get     # 获得station对应的peer统计信息
# iw wlan0 set bitrates legacy-2.4 12 18 24    # 修改传输比特率
# iw dev wlan0 set bitrates mcs-5 4    # 修改tx HT MCS的比特率
# iw dev wlan0 set bitrates mcs-2.4 10
# iw dev wlan0 set bitrates mcs-5    # 清除所有 tx 比特率和设置的东西来恢复正常
# iw dev  set txpower  []   #设置传输功率
# iw phy  set txpower  []   #设置传输功率
# iw dev wlan0 set power_save on  #设置省电模式
# iw dev wlan0 get power_save  #查询当前的节电设定
# iw phy phy0 interface add moni0 type monitor  #添加一个 monitor 接口

```



实例

```
pi@raspberrypi:~ $ sudo iw dev wlan0 scan
BSS 30:4a:26:50:75:48(on wlan0)
	TSF: 0 usec (0d, 00:00:00)
	freq: 2412
	beacon interval: 100 TUs
	capability: ESS Privacy ShortSlotTime (0x0411)
	signal: -15.00 dBm
	last seen: 0 ms ago
	SSID: lyndon_7549
	Supported rates: 1.0* 2.0* 5.5* 11.0* 9.0 18.0 36.0 54.0 
	DS Parameter set: channel 1
	ERP: Use_Protection Barker_Preamble_Mode
	Extended supported rates: 6.0 12.0 24.0 48.0 
	HT capabilities:
		Capabilities: 0x2c
			HT20
			SM Power Save disabled
			RX HT20 SGI
			No RX STBC
			Max AMSDU length: 3839 bytes
			No DSSS/CCK HT40
		Maximum RX AMPDU length 65535 bytes (exponent: 0x003)
		Minimum RX AMPDU time spacing: 4 usec (0x05)
		HT RX MCS rate indexes supported: 0-7
		HT TX MCS rate indexes are undefined
	HT operation:
		 * primary channel: 1	//当前主信道
		 * secondary channel offset: no secondary //因为802.11n中40MHz是通过一个20MHz主信道向上或向下绑定一个不重叠辅助20MHz信道来实现的，所以这个字段可设置AP通过什么方式来实现40MHz;设置为1表示第二信道是向上偏置，设置为3表示第二信道向下偏置，设置为0表示当期没有第二信道。
		 * STA channel width: 20 MHz	//定义可用于传输给STA的信道带宽为20MHz
		 * RIFS: 0	//减短帧间间隔，1：开启，0：禁用
		 * HT protection: no
		 * non-GF present: 0
		 * OBSS non-GF present: 0
		 * dual beacon: 0
		 * dual CTS protection: 0
		 * STBC beacon: 0
		 * L-SIG TXOP Prot: 0
		 * PCO active: 0
		 * PCO phase: 0
	RSN:	 * Version: 1
		 * Group cipher: TKIP
		 * Pairwise ciphers: TKIP CCMP
		 * Authentication suites: PSK
		 * Capabilities: 1-PTKSA-RC 1-GTKSA-RC (0x0000)
	Extended capabilities:
	WMM:	 * Parameter version 1
		 * BE: CW 15-1023, AIFSN 3
		 * BK: CW 15-1023, AIFSN 7
		 * VI: CW 7-15, AIFSN 2, TXOP 3008 usec
		 * VO: CW 3-7, AIFSN 2, TXOP 1504 usec
	Country: US	Environment: Indoor/Outdoor
		Channels [1 - 11] @ 16 dBm

```



## # wpa_cli

## # wpa_supplicant





参考：

[iwlist/iwconfig/iw命令](https://blog.csdn.net/u010164190/article/details/68942070?depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1&utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1)  
[Wireless network configuration (简体中文)](https://wiki.archlinux.org/index.php/Wireless_network_configuration_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E5%85%B3%E8%81%94)  
[wpa_supplicant 常用操作](https://blog.csdn.net/z2066411585/article/details/78761753)